# 人脸客流统计技能<a name="hilens_02_0124"></a>

## 技能描述<a name="section1357181318240"></a>

智慧门店的人脸抓拍和客流统计技能。本技能使用多个深度学习算法，实时分析视频流，对进入门店的人形进行抓拍，并自动筛选出此人进店过程中尺寸、清晰度、角度最佳的人脸和对应的原图上传至您的后台系统。

结合云上人脸识别服务（Face Recognition，简称FRS）还可以进一步做VIP客户统计、回头客统计等应用。使用时需要提供您的业务RESTful接口和RTSP视频地址，当前最大支持两路网络摄像头接入。

>![](public_sys-resources/icon-note.gif) **说明：** 
>人流较密集、互相遮挡或者全程看不清顾客的脸时，可能存在抓取到的人形找不到对应人脸的情况。

摄像头部署建议请参见[摄像头部署](#section18907148151)。

技能配置项请参见[运行时配置参数](#section58183119248)。

技能接口设计请参见[技能结果上传接口](#section1871163922414)。

## 基本信息<a name="section7356181917248"></a>

人脸客流统计技能的基本信息如[表1](#table131035189392)所示。

**表 1**  技能参数说明

<a name="table131035189392"></a>
<table><thead align="left"><tr id="row9104141819394"><th class="cellrowborder" valign="top" width="50%" id="mcps1.2.3.1.1"><p id="p48712053133914"><a name="p48712053133914"></a><a name="p48712053133914"></a>参数</p>
</th>
<th class="cellrowborder" valign="top" width="50%" id="mcps1.2.3.1.2"><p id="p15871653123910"><a name="p15871653123910"></a><a name="p15871653123910"></a>说明</p>
</th>
</tr>
</thead>
<tbody><tr id="row210441843913"><td class="cellrowborder" valign="top" width="50%" headers="mcps1.2.3.1.1 "><p id="p17197181230"><a name="p17197181230"></a><a name="p17197181230"></a>技能名称</p>
</td>
<td class="cellrowborder" valign="top" width="50%" headers="mcps1.2.3.1.2 "><p id="p1271941811237"><a name="p1271941811237"></a><a name="p1271941811237"></a>人脸客流统计</p>
</td>
</tr>
<tr id="row610412187392"><td class="cellrowborder" valign="top" width="50%" headers="mcps1.2.3.1.1 "><p id="p127191418172311"><a name="p127191418172311"></a><a name="p127191418172311"></a>应用场景</p>
</td>
<td class="cellrowborder" valign="top" width="50%" headers="mcps1.2.3.1.2 "><p id="p14719141812232"><a name="p14719141812232"></a><a name="p14719141812232"></a>智慧门店</p>
</td>
</tr>
<tr id="row1710451813393"><td class="cellrowborder" valign="top" width="50%" headers="mcps1.2.3.1.1 "><p id="p97191818162316"><a name="p97191818162316"></a><a name="p97191818162316"></a>支持固件版本</p>
</td>
<td class="cellrowborder" valign="top" width="50%" headers="mcps1.2.3.1.2 "><p id="p163558094017"><a name="p163558094017"></a><a name="p163558094017"></a>HiLens Framework 1.1.2及以上，升级操作请见<a href="升级HiLens_Device_Agent固件版本.md">升级HiLens_Device_Agent固件版本</a></p>
<p id="p12719131852314"><a name="p12719131852314"></a><a name="p12719131852314"></a>系统固件要求为2.2.200.011（TR6），升级操作请见<a href="升级HiLens-Kit系统固件版本.md">升级HiLens Kit系统固件版本</a></p>
</td>
</tr>
<tr id="row19104181811397"><td class="cellrowborder" valign="top" width="50%" headers="mcps1.2.3.1.1 "><p id="p77194184230"><a name="p77194184230"></a><a name="p77194184230"></a>最大路数</p>
</td>
<td class="cellrowborder" valign="top" width="50%" headers="mcps1.2.3.1.2 "><p id="p471919186235"><a name="p471919186235"></a><a name="p471919186235"></a>最多2路</p>
</td>
</tr>
<tr id="row12104151812396"><td class="cellrowborder" valign="top" width="50%" headers="mcps1.2.3.1.1 "><p id="p157191918162313"><a name="p157191918162313"></a><a name="p157191918162313"></a>视频流传输协议</p>
</td>
<td class="cellrowborder" valign="top" width="50%" headers="mcps1.2.3.1.2 "><p id="p15719201810236"><a name="p15719201810236"></a><a name="p15719201810236"></a>RTSP</p>
</td>
</tr>
<tr id="row210411183394"><td class="cellrowborder" valign="top" width="50%" headers="mcps1.2.3.1.1 "><p id="p1871918182235"><a name="p1871918182235"></a><a name="p1871918182235"></a>输入方式</p>
</td>
<td class="cellrowborder" valign="top" width="50%" headers="mcps1.2.3.1.2 "><p id="p147191818172318"><a name="p147191818172318"></a><a name="p147191818172318"></a>外接IPC摄像头</p>
</td>
</tr>
<tr id="row21048181396"><td class="cellrowborder" valign="top" width="50%" headers="mcps1.2.3.1.1 "><p id="p371931802315"><a name="p371931802315"></a><a name="p371931802315"></a>输出方式</p>
</td>
<td class="cellrowborder" valign="top" width="50%" headers="mcps1.2.3.1.2 "><p id="p3719191832316"><a name="p3719191832316"></a><a name="p3719191832316"></a>POST</p>
</td>
</tr>
</tbody>
</table>

## 摄像头部署<a name="section18907148151"></a>

摄像头的架设会影响人脸客流统计模型的准确率。在实际架设中，尽量保证拍摄画面清晰，光照充足，人脸较正，无遮挡，比如前边的人脸容易挡住后边的人脸。监控视频场景下尽量保证拍摄的画面能拍到更多的正脸。

**摄像头参数基本设置**

不同品牌的摄像头都有一些基本的视频设置，例如分辨率、帧率和码率等，参数要求如[表2](#table787920252371)所示。

**表 2**  摄像头参数设置要求

<a name="table787920252371"></a>
<table><thead align="left"><tr id="row16879525113713"><th class="cellrowborder" valign="top" width="50%" id="mcps1.2.3.1.1"><p id="p3879182593715"><a name="p3879182593715"></a><a name="p3879182593715"></a>参数</p>
</th>
<th class="cellrowborder" valign="top" width="50%" id="mcps1.2.3.1.2"><p id="p1787912553715"><a name="p1787912553715"></a><a name="p1787912553715"></a>要求</p>
</th>
</tr>
</thead>
<tbody><tr id="row118796256375"><td class="cellrowborder" valign="top" width="50%" headers="mcps1.2.3.1.1 "><p id="p787912563715"><a name="p787912563715"></a><a name="p787912563715"></a><strong id="b539850103716"><a name="b539850103716"></a><a name="b539850103716"></a>分辨率</strong></p>
</td>
<td class="cellrowborder" valign="top" width="50%" headers="mcps1.2.3.1.2 "><p id="p5879172519372"><a name="p5879172519372"></a><a name="p5879172519372"></a>不低于720P，若需要做人脸识别和去重不低于1080P，不高于4K（3840*2160）。</p>
</td>
</tr>
<tr id="row1587972533712"><td class="cellrowborder" valign="top" width="50%" headers="mcps1.2.3.1.1 "><p id="p687912255377"><a name="p687912255377"></a><a name="p687912255377"></a><strong id="b116741159163713"><a name="b116741159163713"></a><a name="b116741159163713"></a>帧率</strong></p>
</td>
<td class="cellrowborder" valign="top" width="50%" headers="mcps1.2.3.1.2 "><p id="p88797256373"><a name="p88797256373"></a><a name="p88797256373"></a>不高于25fps，不低于15fps，建议值20fps。</p>
</td>
</tr>
<tr id="row187982523716"><td class="cellrowborder" valign="top" width="50%" headers="mcps1.2.3.1.1 "><p id="p128798256372"><a name="p128798256372"></a><a name="p128798256372"></a><strong id="b8443311143811"><a name="b8443311143811"></a><a name="b8443311143811"></a>码率</strong></p>
</td>
<td class="cellrowborder" valign="top" width="50%" headers="mcps1.2.3.1.2 "><p id="p1187922513378"><a name="p1187922513378"></a><a name="p1187922513378"></a>720P建议设为4096Kbps~6144Kbps左右，1080P建议设为6144Kpbs~8192Kbps，更高分辨率可设置更高码率。</p>
</td>
</tr>
<tr id="row1887902563710"><td class="cellrowborder" valign="top" width="50%" headers="mcps1.2.3.1.1 "><p id="p15879202543712"><a name="p15879202543712"></a><a name="p15879202543712"></a><strong id="b136551722183817"><a name="b136551722183817"></a><a name="b136551722183817"></a>视频编码</strong></p>
</td>
<td class="cellrowborder" valign="top" width="50%" headers="mcps1.2.3.1.2 "><p id="p3879102553711"><a name="p3879102553711"></a><a name="p3879102553711"></a>若支持H.265，设置为H.265。</p>
</td>
</tr>
<tr id="row087912510377"><td class="cellrowborder" valign="top" width="50%" headers="mcps1.2.3.1.1 "><p id="p3879132516379"><a name="p3879132516379"></a><a name="p3879132516379"></a><strong id="b4871153118384"><a name="b4871153118384"></a><a name="b4871153118384"></a>日夜切换</strong></p>
</td>
<td class="cellrowborder" valign="top" width="50%" headers="mcps1.2.3.1.2 "><p id="p187912512378"><a name="p187912512378"></a><a name="p187912512378"></a>关闭夜间自动切换红外模式，暂不支持抓取红外模式下的人脸。</p>
</td>
</tr>
<tr id="row1687912513714"><td class="cellrowborder" valign="top" width="50%" headers="mcps1.2.3.1.1 "><p id="p1587992514373"><a name="p1587992514373"></a><a name="p1587992514373"></a><strong id="b171671841113817"><a name="b171671841113817"></a><a name="b171671841113817"></a>宽动态</strong></p>
</td>
<td class="cellrowborder" valign="top" width="50%" headers="mcps1.2.3.1.2 "><p id="p887982513712"><a name="p887982513712"></a><a name="p887982513712"></a>关闭宽动态。普通摄像头的宽动态无法到达专业相机的效果，人的走动速度较快时存在运动模糊，应关闭宽动态设置。</p>
</td>
</tr>
</tbody>
</table>

**人脸角度要求**

人脸角度按照三个维度定义：人脸抬头低头角度（pitch），正面人脸旋转角度（roll），前后转头偏转角度（yaw）。人脸检测算法对三个空间维度都有限制。检测模型根据三个维度做姿态评估以后，将检测到的人脸图片发送出来。如果摄像头安装角度不合适，拍摄的画面容易将一些正脸误检为侧脸，在安装好摄像头以后，需要安装人员在现场走进画面实际测试，确认拍摄的人脸画面不产生过大的角度，不会造成算法无法抓到人脸。

请保证人在正常行走中，视频中人脸成像前后转头偏转角度“yaw“不超过45°（即摄像头无斜拍），人脸抬头低头角度“pitch“不超过30°（即摄像头架设俯视角合理），人脸旋转角度“roll“不超过20°（即摄像头两侧水平，无倾斜角），满足上述正脸姿态要求。

**人脸大小要求**

对于不可调焦距的摄像头，摄像头应安装在距离抓拍点较近处，使得人脸在画面中的像素大小不小于30px\*30px。摄像头架设建议如下。

架设高度：2m-2.5m

监控距离：5m-6m

监控宽度：2m-3m

俯视角度：15°左右

对于可调焦距摄像头，应调节焦段使得人脸像素大小满足大于30px\*30px的要求。

如果抓取人脸后还需发送给FRS服务，请保证人脸像素大小大于80px\*80px，对应设置[运行时配置参数](#section58183119248)中的“cropSizeMin“参数值为“80“。

**光照要求**

光照条件要求需要满足以下几项：

-   行人正脸光照强度较好，光线过强和过弱都不太合适。

    如果不满足此要求，例如在夜晚或光线不足的白天等环境，会使得采集人脸图像曝光不足，获取的人脸画面偏暗、噪点偏多，导致发送至FRS服务的图片正确率偏低。

-   人脸两侧光照强度差值不宜过大。

    如果不满足此要求，即左右侧光照强度如果差异过大，采集的人脸图像有“阴阳脸“现象（半张脸暗，半张脸亮）。

-   行人背面光照强度<正面光照强度\* 2。

    如果不满足此要求，即行人背面光照强度远大于正面光照强度，采集人脸图像有严重“背光“现象，最终导致人脸曝光不足，五官细节丢失。

-   室外安装摄像头不宜正对着太阳光，会导致人脸拍摄光照不均，造成人脸反光。

    如果不满足此要求，会导致光线太强和太弱，人脸五官细节都会丢失。

-   室外摄像头安装，不宜选择背阴严重或者有遮挡物挡住光线的地方架设。

    如果不满足此要求，会导致光线太强和太弱，人脸五官细节都会丢失。


如果现场的光线不满足上述要求，则需要通过强光抑制或补光来优化现场的光照条件。强光抑制可以改善“阴阳脸“、“背光“现象，即通过减弱侧面光照来改善光照条件。补光则可以通过增加额外光源的方式改善光照条件，提高人脸图像的采集效果；主要通过普通射灯、白炽灯等在不影响装修、路人视觉效果的情况下提高人脸的光照度，消除“阴阳脸“。

**周围环境要求**

-   镜头前方不要有遮挡的障碍物，容易挡住人脸，造成漏检。
-   不要将摄像头架在房子遮阴的挡板下，会造成光照过暗，人脸完全看不清。
-   室内安装摄像头，部署在楼道里需要注意光照，楼道里灯光明暗交替变化过快，摄像头拍摄时获取的画面可能会偏暗，检测到的人脸发送给FRS后，正确率较低。比如，走廊较长，楼道光照较暗，人距离摄像头较远时，检测出的人脸很模糊。
-   室外安装摄像头，需要注意雨雪的影响，避免在露天下布置，雨水或者雪将摄像头的镜头盖住，造成拍摄画面模糊不清。

**进店划线设置要求**

人脸客流统计技能根据划线参数（passLineThreshold，详见[表4](#table4476192818405)）判断顾客是否进店，该参数的设置与摄像头画面有较大关联，建议如下：

-   保证正常身高的人站在门槛处，能完整的看到整个人形，清晰的看到正脸（人脸条件满足上面的要求）；
-   门槛建议处于画面垂直距离80%\~90%左右，即画面中80%\~90%为店外，10%\~20%为店内。

## 运行时配置参数<a name="section58183119248"></a>

技能在运行时，需要[添加运行时配置](添加运行时配置.md)。配置完成后，参数会从华为HiLens云侧下发到端侧设备。

-   **配置参数说明**

    技能相关配置参数设计如[表3](#table165162714399)所示。

    **表 3**  运行时配置参数

    <a name="table165162714399"></a>
    <table><thead align="left"><tr id="row67632714392"><th class="cellrowborder" valign="top" width="30.620000000000005%" id="mcps1.2.5.1.1"><p id="p376192715392"><a name="p376192715392"></a><a name="p376192715392"></a>名称</p>
    </th>
    <th class="cellrowborder" valign="top" width="12.23%" id="mcps1.2.5.1.2"><p id="p57622714395"><a name="p57622714395"></a><a name="p57622714395"></a>是否必选</p>
    </th>
    <th class="cellrowborder" valign="top" width="16.33%" id="mcps1.2.5.1.3"><p id="p976827163914"><a name="p976827163914"></a><a name="p976827163914"></a>参数类型</p>
    </th>
    <th class="cellrowborder" valign="top" width="40.82%" id="mcps1.2.5.1.4"><p id="p157642719395"><a name="p157642719395"></a><a name="p157642719395"></a>说明</p>
    </th>
    </tr>
    </thead>
    <tbody><tr id="row181581519114"><td class="cellrowborder" valign="top" width="30.620000000000005%" headers="mcps1.2.5.1.1 "><p id="p181581758113"><a name="p181581758113"></a><a name="p181581758113"></a>logLevel</p>
    </td>
    <td class="cellrowborder" valign="top" width="12.23%" headers="mcps1.2.5.1.2 "><p id="p1215814521119"><a name="p1215814521119"></a><a name="p1215814521119"></a>是</p>
    </td>
    <td class="cellrowborder" valign="top" width="16.33%" headers="mcps1.2.5.1.3 "><p id="p6158115101110"><a name="p6158115101110"></a><a name="p6158115101110"></a>Enum</p>
    </td>
    <td class="cellrowborder" valign="top" width="40.82%" headers="mcps1.2.5.1.4 "><p id="p1215910541116"><a name="p1215910541116"></a><a name="p1215910541116"></a>日志级别，包括INFO，DEBUG，WARNING和ERROR。建议设置为INFO。</p>
    </td>
    </tr>
    <tr id="row310714016111"><td class="cellrowborder" valign="top" width="30.620000000000005%" headers="mcps1.2.5.1.1 "><p id="p11107240191114"><a name="p11107240191114"></a><a name="p11107240191114"></a>keep_running</p>
    </td>
    <td class="cellrowborder" valign="top" width="12.23%" headers="mcps1.2.5.1.2 "><p id="p11107154011117"><a name="p11107154011117"></a><a name="p11107154011117"></a>是</p>
    </td>
    <td class="cellrowborder" valign="top" width="16.33%" headers="mcps1.2.5.1.3 "><p id="p210734061112"><a name="p210734061112"></a><a name="p210734061112"></a>Int</p>
    </td>
    <td class="cellrowborder" valign="top" width="40.82%" headers="mcps1.2.5.1.4 "><p id="p19107104012118"><a name="p19107104012118"></a><a name="p19107104012118"></a>当技能崩溃是否自动拉起技能并持续运行。此项配置在1.1.0及以后版本起作用。</p>
    </td>
    </tr>
    <tr id="row476192793915"><td class="cellrowborder" valign="top" width="30.620000000000005%" headers="mcps1.2.5.1.1 "><p id="p476527113911"><a name="p476527113911"></a><a name="p476527113911"></a>multi_camera</p>
    </td>
    <td class="cellrowborder" valign="top" width="12.23%" headers="mcps1.2.5.1.2 "><p id="p876142713920"><a name="p876142713920"></a><a name="p876142713920"></a>是</p>
    </td>
    <td class="cellrowborder" valign="top" width="16.33%" headers="mcps1.2.5.1.3 "><p id="p20761273395"><a name="p20761273395"></a><a name="p20761273395"></a>List</p>
    </td>
    <td class="cellrowborder" valign="top" width="40.82%" headers="mcps1.2.5.1.4 "><p id="p1976152715396"><a name="p1976152715396"></a><a name="p1976152715396"></a>一个设备上多路视频的技能参数，详情请参见<a href="#table4476192818405">表4</a>。</p>
    </td>
    </tr>
    </tbody>
    </table>

    **表 4**  视频参数说明

    <a name="table4476192818405"></a>
    <table><thead align="left"><tr id="row6517328114017"><th class="cellrowborder" valign="top" width="28.57%" id="mcps1.2.5.1.1"><p id="p551732814017"><a name="p551732814017"></a><a name="p551732814017"></a>名称</p>
    </th>
    <th class="cellrowborder" valign="top" width="8.61%" id="mcps1.2.5.1.2"><p id="p175176286401"><a name="p175176286401"></a><a name="p175176286401"></a>是否必选</p>
    </th>
    <th class="cellrowborder" valign="top" width="11.799999999999999%" id="mcps1.2.5.1.3"><p id="p55174288409"><a name="p55174288409"></a><a name="p55174288409"></a>参数类型</p>
    </th>
    <th class="cellrowborder" valign="top" width="51.019999999999996%" id="mcps1.2.5.1.4"><p id="p4517172824011"><a name="p4517172824011"></a><a name="p4517172824011"></a>说明</p>
    </th>
    </tr>
    </thead>
    <tbody><tr id="row8517828194010"><td class="cellrowborder" valign="top" width="28.57%" headers="mcps1.2.5.1.1 "><p id="p1351722817402"><a name="p1351722817402"></a><a name="p1351722817402"></a>camera_names</p>
    </td>
    <td class="cellrowborder" valign="top" width="8.61%" headers="mcps1.2.5.1.2 "><p id="p7517328114011"><a name="p7517328114011"></a><a name="p7517328114011"></a>是</p>
    </td>
    <td class="cellrowborder" valign="top" width="11.799999999999999%" headers="mcps1.2.5.1.3 "><p id="p10517628144011"><a name="p10517628144011"></a><a name="p10517628144011"></a>List</p>
    </td>
    <td class="cellrowborder" valign="top" width="51.019999999999996%" headers="mcps1.2.5.1.4 "><p id="p25173287402"><a name="p25173287402"></a><a name="p25173287402"></a>摄像头名称。可配置多个名称，表示多个摄像头采用同样的技能配置。</p>
    </td>
    </tr>
    <tr id="row9517132814404"><td class="cellrowborder" valign="top" width="28.57%" headers="mcps1.2.5.1.1 "><p id="p165171328174017"><a name="p165171328174017"></a><a name="p165171328174017"></a>sendOriImgFlag</p>
    </td>
    <td class="cellrowborder" valign="top" width="8.61%" headers="mcps1.2.5.1.2 "><p id="p12517928124019"><a name="p12517928124019"></a><a name="p12517928124019"></a>否</p>
    </td>
    <td class="cellrowborder" valign="top" width="11.799999999999999%" headers="mcps1.2.5.1.3 "><p id="p3517162804016"><a name="p3517162804016"></a><a name="p3517162804016"></a>Int</p>
    </td>
    <td class="cellrowborder" valign="top" width="51.019999999999996%" headers="mcps1.2.5.1.4 "><p id="p13517132817403"><a name="p13517132817403"></a><a name="p13517132817403"></a>是否发送人脸背景原始图,默认值：0。</p>
    <p id="p135171284409"><a name="p135171284409"></a><a name="p135171284409"></a>0：表示不发送</p>
    <p id="p1351712894015"><a name="p1351712894015"></a><a name="p1351712894015"></a>1：表示发送</p>
    </td>
    </tr>
    <tr id="row4517228174019"><td class="cellrowborder" valign="top" width="28.57%" headers="mcps1.2.5.1.1 "><p id="p195171284402"><a name="p195171284402"></a><a name="p195171284402"></a>sendOriImgCompressionRatio</p>
    </td>
    <td class="cellrowborder" valign="top" width="8.61%" headers="mcps1.2.5.1.2 "><p id="p105176289400"><a name="p105176289400"></a><a name="p105176289400"></a>否</p>
    </td>
    <td class="cellrowborder" valign="top" width="11.799999999999999%" headers="mcps1.2.5.1.3 "><p id="p1951782864012"><a name="p1951782864012"></a><a name="p1951782864012"></a>Int</p>
    </td>
    <td class="cellrowborder" valign="top" width="51.019999999999996%" headers="mcps1.2.5.1.4 "><p id="p175172282402"><a name="p175172282402"></a><a name="p175172282402"></a>原始图jpeg压缩百分比，默认值为90,表示图片压缩比90%，取值范围[1 100]。</p>
    </td>
    </tr>
    <tr id="row7517428124019"><td class="cellrowborder" valign="top" width="28.57%" headers="mcps1.2.5.1.1 "><p id="p14517202884011"><a name="p14517202884011"></a><a name="p14517202884011"></a>cropSizeMax</p>
    </td>
    <td class="cellrowborder" valign="top" width="8.61%" headers="mcps1.2.5.1.2 "><p id="p145177288404"><a name="p145177288404"></a><a name="p145177288404"></a>否</p>
    </td>
    <td class="cellrowborder" valign="top" width="11.799999999999999%" headers="mcps1.2.5.1.3 "><p id="p185174285408"><a name="p185174285408"></a><a name="p185174285408"></a>Int</p>
    </td>
    <td class="cellrowborder" valign="top" width="51.019999999999996%" headers="mcps1.2.5.1.4 "><p id="p7517328164011"><a name="p7517328164011"></a><a name="p7517328164011"></a>发送人脸图片长宽的最大像素，默认值400。</p>
    </td>
    </tr>
    <tr id="row9517172810402"><td class="cellrowborder" valign="top" width="28.57%" headers="mcps1.2.5.1.1 "><p id="p651717288402"><a name="p651717288402"></a><a name="p651717288402"></a>cropSizeMin</p>
    </td>
    <td class="cellrowborder" valign="top" width="8.61%" headers="mcps1.2.5.1.2 "><p id="p19517122874018"><a name="p19517122874018"></a><a name="p19517122874018"></a>否</p>
    </td>
    <td class="cellrowborder" valign="top" width="11.799999999999999%" headers="mcps1.2.5.1.3 "><p id="p25171728124015"><a name="p25171728124015"></a><a name="p25171728124015"></a>Int</p>
    </td>
    <td class="cellrowborder" valign="top" width="51.019999999999996%" headers="mcps1.2.5.1.4 "><p id="p1517112834018"><a name="p1517112834018"></a><a name="p1517112834018"></a>发送人脸图片长宽的最小像素，默认值80。</p>
    </td>
    </tr>
    <tr id="row751717280408"><td class="cellrowborder" valign="top" width="28.57%" headers="mcps1.2.5.1.1 "><p id="p115171428124015"><a name="p115171428124015"></a><a name="p115171428124015"></a>faceQualityThreshold</p>
    </td>
    <td class="cellrowborder" valign="top" width="8.61%" headers="mcps1.2.5.1.2 "><p id="p115173287403"><a name="p115173287403"></a><a name="p115173287403"></a>否</p>
    </td>
    <td class="cellrowborder" valign="top" width="11.799999999999999%" headers="mcps1.2.5.1.3 "><p id="p13517182816406"><a name="p13517182816406"></a><a name="p13517182816406"></a>Float</p>
    </td>
    <td class="cellrowborder" valign="top" width="51.019999999999996%" headers="mcps1.2.5.1.4 "><p id="p16517152819404"><a name="p16517152819404"></a><a name="p16517152819404"></a>人脸质量总分阈值，质量分<strong id="b8450154412210"><a name="b8450154412210"></a><a name="b8450154412210"></a>大于</strong>此值的人脸才会抓拍，默认值0.25。</p>
    </td>
    </tr>
    <tr id="row11543182818389"><td class="cellrowborder" valign="top" width="28.57%" headers="mcps1.2.5.1.1 "><p id="p342316454382"><a name="p342316454382"></a><a name="p342316454382"></a>facePoseThreshold</p>
    </td>
    <td class="cellrowborder" valign="top" width="8.61%" headers="mcps1.2.5.1.2 "><p id="p8423045153817"><a name="p8423045153817"></a><a name="p8423045153817"></a>否</p>
    </td>
    <td class="cellrowborder" valign="top" width="11.799999999999999%" headers="mcps1.2.5.1.3 "><p id="p2423144543812"><a name="p2423144543812"></a><a name="p2423144543812"></a>Float</p>
    </td>
    <td class="cellrowborder" valign="top" width="51.019999999999996%" headers="mcps1.2.5.1.4 "><p id="p1042324518381"><a name="p1042324518381"></a><a name="p1042324518381"></a>人脸姿态分阈值，质量分<strong id="b15414912213"><a name="b15414912213"></a><a name="b15414912213"></a>小于</strong>此值的人脸才会抓拍，默认值0.45。</p>
    </td>
    </tr>
    <tr id="row12783953820"><td class="cellrowborder" valign="top" width="28.57%" headers="mcps1.2.5.1.1 "><p id="p1042617479382"><a name="p1042617479382"></a><a name="p1042617479382"></a>faceBlurThreshold</p>
    </td>
    <td class="cellrowborder" valign="top" width="8.61%" headers="mcps1.2.5.1.2 "><p id="p74267478383"><a name="p74267478383"></a><a name="p74267478383"></a>否</p>
    </td>
    <td class="cellrowborder" valign="top" width="11.799999999999999%" headers="mcps1.2.5.1.3 "><p id="p042664713820"><a name="p042664713820"></a><a name="p042664713820"></a>Float</p>
    </td>
    <td class="cellrowborder" valign="top" width="51.019999999999996%" headers="mcps1.2.5.1.4 "><p id="p4426184703819"><a name="p4426184703819"></a><a name="p4426184703819"></a>人脸模糊度阈值，质量分<strong id="b978914521222"><a name="b978914521222"></a><a name="b978914521222"></a>小于</strong>此值的人脸才会抓拍，默认值0.55。</p>
    </td>
    </tr>
    <tr id="row109295124013"><td class="cellrowborder" valign="top" width="28.57%" headers="mcps1.2.5.1.1 "><p id="p189210518401"><a name="p189210518401"></a><a name="p189210518401"></a>faceMargin</p>
    </td>
    <td class="cellrowborder" valign="top" width="8.61%" headers="mcps1.2.5.1.2 "><p id="p102161427184013"><a name="p102161427184013"></a><a name="p102161427184013"></a>是</p>
    </td>
    <td class="cellrowborder" valign="top" width="11.799999999999999%" headers="mcps1.2.5.1.3 "><p id="p1216227134017"><a name="p1216227134017"></a><a name="p1216227134017"></a>Float</p>
    </td>
    <td class="cellrowborder" valign="top" width="51.019999999999996%" headers="mcps1.2.5.1.4 "><p id="p10921151409"><a name="p10921151409"></a><a name="p10921151409"></a>上报人脸时人脸框的外扩比例，默认值2.0。</p>
    </td>
    </tr>
    <tr id="row19283121234015"><td class="cellrowborder" valign="top" width="28.57%" headers="mcps1.2.5.1.1 "><p id="p828371218409"><a name="p828371218409"></a><a name="p828371218409"></a>passLineThreshold</p>
    </td>
    <td class="cellrowborder" valign="top" width="8.61%" headers="mcps1.2.5.1.2 "><p id="p172863461409"><a name="p172863461409"></a><a name="p172863461409"></a>否</p>
    </td>
    <td class="cellrowborder" valign="top" width="11.799999999999999%" headers="mcps1.2.5.1.3 "><p id="p3286104617401"><a name="p3286104617401"></a><a name="p3286104617401"></a>Float</p>
    </td>
    <td class="cellrowborder" valign="top" width="51.019999999999996%" headers="mcps1.2.5.1.4 "><p id="p3141651154017"><a name="p3141651154017"></a><a name="p3141651154017"></a>进店统计时判断过线的Y轴坐标比值，默认为0.9。例如分辨率为1920x1080，比值0.75即1080*0.75=810。</p>
    </td>
    </tr>
    <tr id="row769117892917"><td class="cellrowborder" valign="top" width="28.57%" headers="mcps1.2.5.1.1 "><p id="p5691198172915"><a name="p5691198172915"></a><a name="p5691198172915"></a>sendUrl</p>
    </td>
    <td class="cellrowborder" valign="top" width="8.61%" headers="mcps1.2.5.1.2 "><p id="p5691387297"><a name="p5691387297"></a><a name="p5691387297"></a>是</p>
    </td>
    <td class="cellrowborder" valign="top" width="11.799999999999999%" headers="mcps1.2.5.1.3 "><p id="p1869220832910"><a name="p1869220832910"></a><a name="p1869220832910"></a>String</p>
    </td>
    <td class="cellrowborder" valign="top" width="51.019999999999996%" headers="mcps1.2.5.1.4 "><p id="p196921581294"><a name="p196921581294"></a><a name="p196921581294"></a>发送技能消息POST请求的URL地址。</p>
    </td>
    </tr>
    </tbody>
    </table>

-   **示例**

    HiLens Kit设备支持多路摄像头接入，如果要为不同的摄像头设置不同的技能配置，或者几个摄像头共用同一技能配置，则可在配置列表中给出相应的配置信息，示例如下：

    ```
    //Store001的两个摄像头pos1和pos2配置不同参数：
    { 
      "logLevel": "INFO",
      "keep_running": 1,
      "multi_camera": 
             [{
              "camera_names": ["store001_pos1"],
              "sendOriImgFlag": 0,
              "sendOriImgCompressionRatio": 90,
              "cropSizeMax": 400,
              "cropSizeMin": 100,
              "faceQualityThreshold": 0.25,
              "facePoseThreshold": 0.45,
              "faceBlurThreshold": 0.55,
              "faceMargin": 2.0,
              "passLineThreshold": 0.9,
              "sendUrl": "https://abc.company.com/face",
             },
             {
              "camera_names": ["store001_pos2"],
              "sendOriImgFlag": 1,
              "sendOriImgCompressionRatio": 100,
              "cropSizeMax": 300,
              "cropSizeMin": 80,
              "faceQualityThreshold": 0.25,
              "facePoseThreshold": 0.45,
              "faceBlurThreshold": 0.55,
              "faceMargin": 2.0,
              "passLineThreshold": 0.9,
              "sendUrl": "https://abc.company.com/face",
              }]
    }
    //Store002的两个摄像头pos1和pos2配置相同参数：
    { 
      "logLevel": "INFO",
      "keep_running": 1,
      "multi_camera": 
             [{
              "camera_names": ["store002_pos1","store002_pos2"],
              "sendOriImgFlag": 0,
              "sendOriImgCompressionRatio": 90,
              "cropSizeMax": 400,
              "cropSizeMin": 120,
              "faceQualityThreshold": 0.25,
              "facePoseThreshold": 0.45,
              "faceBlurThreshold": 0.55,
              "faceMargin": 2.0,
              "passLineThreshold": 0.9,
              "sendUrl": "https://abc.company.com/face",
             }]
    }
    ```


## 技能结果上传接口<a name="section1871163922414"></a>

-   **请求消息**

    推理结果将以HTTPS POST请求方法推送到应用系统server的指定URL地址。

    **POST \{sendUrl\}**

    其中**sendUrl**在[技能运行时配置](添加运行时配置.md)中设置。

    -   请求消息头

        技能以json形式返回推理结果，因此消息头**Content-Type**类型为“application/json”，参数说明如[表5](#table05762053122917)所示。

        **表 5**  请求消息头参数说明

        <a name="table05762053122917"></a>
        <table><thead align="left"><tr id="row176071253162910"><th class="cellrowborder" valign="top" width="19.39%" id="mcps1.2.5.1.1"><p id="p1160775316297"><a name="p1160775316297"></a><a name="p1160775316297"></a>名称</p>
        </th>
        <th class="cellrowborder" valign="top" width="26.530000000000005%" id="mcps1.2.5.1.2"><p id="p260765312910"><a name="p260765312910"></a><a name="p260765312910"></a>描述</p>
        </th>
        <th class="cellrowborder" valign="top" width="19.39%" id="mcps1.2.5.1.3"><p id="p16607653132913"><a name="p16607653132913"></a><a name="p16607653132913"></a>是否必选</p>
        </th>
        <th class="cellrowborder" valign="top" width="34.690000000000005%" id="mcps1.2.5.1.4"><p id="p16071253102911"><a name="p16071253102911"></a><a name="p16071253102911"></a>示例</p>
        </th>
        </tr>
        </thead>
        <tbody><tr id="row10607195318295"><td class="cellrowborder" valign="top" width="19.39%" headers="mcps1.2.5.1.1 "><p id="p1760765316293"><a name="p1760765316293"></a><a name="p1760765316293"></a>Content-Type</p>
        </td>
        <td class="cellrowborder" valign="top" width="26.530000000000005%" headers="mcps1.2.5.1.2 "><p id="p16607253132911"><a name="p16607253132911"></a><a name="p16607253132911"></a>消息体的类型（格式）</p>
        </td>
        <td class="cellrowborder" valign="top" width="19.39%" headers="mcps1.2.5.1.3 "><p id="p56071253122914"><a name="p56071253122914"></a><a name="p56071253122914"></a>是</p>
        </td>
        <td class="cellrowborder" valign="top" width="34.690000000000005%" headers="mcps1.2.5.1.4 "><p id="p206073533291"><a name="p206073533291"></a><a name="p206073533291"></a>application/json。</p>
        </td>
        </tr>
        </tbody>
        </table>

    -   公共消息体

        华为HiLens 公共消息体包含了技能的公共消息内容，如[表6](#table165121912143213)所示。

        **表 6**  公共消息体参数说明

        <a name="table165121912143213"></a>
        <table><thead align="left"><tr id="row18549112143218"><th class="cellrowborder" valign="top" width="27.27%" id="mcps1.2.4.1.1"><p id="p15549012123215"><a name="p15549012123215"></a><a name="p15549012123215"></a>名称</p>
        </th>
        <th class="cellrowborder" valign="top" width="15.15%" id="mcps1.2.4.1.2"><p id="p4549131243220"><a name="p4549131243220"></a><a name="p4549131243220"></a>类型</p>
        </th>
        <th class="cellrowborder" valign="top" width="57.58%" id="mcps1.2.4.1.3"><p id="p1454910121324"><a name="p1454910121324"></a><a name="p1454910121324"></a>说明</p>
        </th>
        </tr>
        </thead>
        <tbody><tr id="row11549121293211"><td class="cellrowborder" valign="top" width="27.27%" headers="mcps1.2.4.1.1 "><p id="p155494124326"><a name="p155494124326"></a><a name="p155494124326"></a>msg_type</p>
        </td>
        <td class="cellrowborder" valign="top" width="15.15%" headers="mcps1.2.4.1.2 "><p id="p1654981212327"><a name="p1654981212327"></a><a name="p1654981212327"></a>String</p>
        </td>
        <td class="cellrowborder" valign="top" width="57.58%" headers="mcps1.2.4.1.3 "><p id="p55491812113219"><a name="p55491812113219"></a><a name="p55491812113219"></a>技能类型，为face_detection_result。</p>
        </td>
        </tr>
        <tr id="row1454991243217"><td class="cellrowborder" valign="top" width="27.27%" headers="mcps1.2.4.1.1 "><p id="p55491129326"><a name="p55491129326"></a><a name="p55491129326"></a>cam_name</p>
        </td>
        <td class="cellrowborder" valign="top" width="15.15%" headers="mcps1.2.4.1.2 "><p id="p1954961273213"><a name="p1954961273213"></a><a name="p1954961273213"></a>String</p>
        </td>
        <td class="cellrowborder" valign="top" width="57.58%" headers="mcps1.2.4.1.3 "><p id="p125498124321"><a name="p125498124321"></a><a name="p125498124321"></a>摄像头名称。</p>
        </td>
        </tr>
        <tr id="row17549161273211"><td class="cellrowborder" valign="top" width="27.27%" headers="mcps1.2.4.1.1 "><p id="p254951253210"><a name="p254951253210"></a><a name="p254951253210"></a>skill_id</p>
        </td>
        <td class="cellrowborder" valign="top" width="15.15%" headers="mcps1.2.4.1.2 "><p id="p1854991273215"><a name="p1854991273215"></a><a name="p1854991273215"></a>String</p>
        </td>
        <td class="cellrowborder" valign="top" width="57.58%" headers="mcps1.2.4.1.3 "><p id="p15549131213213"><a name="p15549131213213"></a><a name="p15549131213213"></a>技能ID。</p>
        </td>
        </tr>
        <tr id="row145491412183210"><td class="cellrowborder" valign="top" width="27.27%" headers="mcps1.2.4.1.1 "><p id="p154981233217"><a name="p154981233217"></a><a name="p154981233217"></a>device_id</p>
        </td>
        <td class="cellrowborder" valign="top" width="15.15%" headers="mcps1.2.4.1.2 "><p id="p9549112163219"><a name="p9549112163219"></a><a name="p9549112163219"></a>String</p>
        </td>
        <td class="cellrowborder" valign="top" width="57.58%" headers="mcps1.2.4.1.3 "><p id="p125498120328"><a name="p125498120328"></a><a name="p125498120328"></a>设备ID，指代运行此技能的设备。如您的HiLens Kit的设备ID，可登录华为HiLens控制台，在<span class="wintitle" id="wintitle4243171812314"><a name="wintitle4243171812314"></a><a name="wintitle4243171812314"></a>“设备管理&gt;设备列表”</span>页面的设备卡片查看。</p>
        </td>
        </tr>
        </tbody>
        </table>

    -   技能消息体

        人脸客流统计技能的json消息体如[表7](#table290918488313)所示。

        **表 7**  技能消息体参数说明

        <a name="table290918488313"></a>
        <table><thead align="left"><tr id="row15907048123117"><th class="cellrowborder" valign="top" width="27.27%" id="mcps1.2.4.1.1"><p id="p17907048163113"><a name="p17907048163113"></a><a name="p17907048163113"></a>名称</p>
        </th>
        <th class="cellrowborder" valign="top" width="15.15%" id="mcps1.2.4.1.2"><p id="p6907194893115"><a name="p6907194893115"></a><a name="p6907194893115"></a>类型</p>
        </th>
        <th class="cellrowborder" valign="top" width="57.58%" id="mcps1.2.4.1.3"><p id="p1090716485315"><a name="p1090716485315"></a><a name="p1090716485315"></a>说明</p>
        </th>
        </tr>
        </thead>
        <tbody><tr id="row79083487313"><td class="cellrowborder" valign="top" width="27.27%" headers="mcps1.2.4.1.1 "><p id="p1690864812316"><a name="p1690864812316"></a><a name="p1690864812316"></a>time</p>
        </td>
        <td class="cellrowborder" valign="top" width="15.15%" headers="mcps1.2.4.1.2 "><p id="p1908134843114"><a name="p1908134843114"></a><a name="p1908134843114"></a>Uint64</p>
        </td>
        <td class="cellrowborder" valign="top" width="57.58%" headers="mcps1.2.4.1.3 "><p id="p11908184883119"><a name="p11908184883119"></a><a name="p11908184883119"></a>图片解码时间的时间戳，单位为秒。</p>
        </td>
        </tr>
        <tr id="row5908104823117"><td class="cellrowborder" valign="top" width="27.27%" headers="mcps1.2.4.1.1 "><p id="p8908174814316"><a name="p8908174814316"></a><a name="p8908174814316"></a>track_id</p>
        </td>
        <td class="cellrowborder" valign="top" width="15.15%" headers="mcps1.2.4.1.2 "><p id="p109082480315"><a name="p109082480315"></a><a name="p109082480315"></a>Uint64</p>
        </td>
        <td class="cellrowborder" valign="top" width="57.58%" headers="mcps1.2.4.1.3 "><p id="p16908144815311"><a name="p16908144815311"></a><a name="p16908144815311"></a>人的跟踪标记，相同的t<span class="parmname" id="parmname139081548103117"><a name="parmname139081548103117"></a><a name="parmname139081548103117"></a>“rack_id”</span>表示同一个人，每次初始化后<span class="parmname" id="parmname1890814815319"><a name="parmname1890814815319"></a><a name="parmname1890814815319"></a>“track_id”</span>的值为从0开始依次递增。</p>
        </td>
        </tr>
        <tr id="row790894817316"><td class="cellrowborder" valign="top" width="27.27%" headers="mcps1.2.4.1.1 "><p id="p10908154843119"><a name="p10908154843119"></a><a name="p10908154843119"></a>person_id</p>
        </td>
        <td class="cellrowborder" valign="top" width="15.15%" headers="mcps1.2.4.1.2 "><p id="p1490815485312"><a name="p1490815485312"></a><a name="p1490815485312"></a>String</p>
        </td>
        <td class="cellrowborder" valign="top" width="57.58%" headers="mcps1.2.4.1.3 "><p id="p12908548163114"><a name="p12908548163114"></a><a name="p12908548163114"></a>人形UUID。</p>
        </td>
        </tr>
        <tr id="row1908248183112"><td class="cellrowborder" valign="top" width="27.27%" headers="mcps1.2.4.1.1 "><p id="p1490884810311"><a name="p1490884810311"></a><a name="p1490884810311"></a>person_image</p>
        </td>
        <td class="cellrowborder" valign="top" width="15.15%" headers="mcps1.2.4.1.2 "><p id="p79080486314"><a name="p79080486314"></a><a name="p79080486314"></a>String</p>
        </td>
        <td class="cellrowborder" valign="top" width="57.58%" headers="mcps1.2.4.1.3 "><p id="p189081748163115"><a name="p189081748163115"></a><a name="p189081748163115"></a>进店那一刻的原图BASE64编码结果。</p>
        </td>
        </tr>
        <tr id="row2908144816318"><td class="cellrowborder" valign="top" width="27.27%" headers="mcps1.2.4.1.1 "><p id="p7908194863111"><a name="p7908194863111"></a><a name="p7908194863111"></a>ori_img_id</p>
        </td>
        <td class="cellrowborder" valign="top" width="15.15%" headers="mcps1.2.4.1.2 "><p id="p890884812318"><a name="p890884812318"></a><a name="p890884812318"></a>String</p>
        </td>
        <td class="cellrowborder" valign="top" width="57.58%" headers="mcps1.2.4.1.3 "><p id="p19908174823110"><a name="p19908174823110"></a><a name="p19908174823110"></a>人脸对应的原图UUID。</p>
        </td>
        </tr>
        <tr id="row79082486316"><td class="cellrowborder" valign="top" width="27.27%" headers="mcps1.2.4.1.1 "><p id="p890844823110"><a name="p890844823110"></a><a name="p890844823110"></a>ori_image</p>
        </td>
        <td class="cellrowborder" valign="top" width="15.15%" headers="mcps1.2.4.1.2 "><p id="p1990819484312"><a name="p1990819484312"></a><a name="p1990819484312"></a>String</p>
        </td>
        <td class="cellrowborder" valign="top" width="57.58%" headers="mcps1.2.4.1.3 "><p id="p79085487315"><a name="p79085487315"></a><a name="p79085487315"></a>进店过程中的最佳人脸对应的原图BASE64编码结果。</p>
        </td>
        </tr>
        <tr id="row490974815314"><td class="cellrowborder" valign="top" width="27.27%" headers="mcps1.2.4.1.1 "><p id="p19084482319"><a name="p19084482319"></a><a name="p19084482319"></a>face_image</p>
        </td>
        <td class="cellrowborder" valign="top" width="15.15%" headers="mcps1.2.4.1.2 "><p id="p1908848183113"><a name="p1908848183113"></a><a name="p1908848183113"></a>String</p>
        </td>
        <td class="cellrowborder" valign="top" width="57.58%" headers="mcps1.2.4.1.3 "><p id="p18909144853112"><a name="p18909144853112"></a><a name="p18909144853112"></a>进店过程中的最佳人脸图BASE64编码结果。</p>
        </td>
        </tr>
        <tr id="row12909848163119"><td class="cellrowborder" valign="top" width="27.27%" headers="mcps1.2.4.1.1 "><p id="p59091748163115"><a name="p59091748163115"></a><a name="p59091748163115"></a>clarity</p>
        </td>
        <td class="cellrowborder" valign="top" width="15.15%" headers="mcps1.2.4.1.2 "><p id="p49091948133115"><a name="p49091948133115"></a><a name="p49091948133115"></a>Float</p>
        </td>
        <td class="cellrowborder" valign="top" width="57.58%" headers="mcps1.2.4.1.3 "><p id="p6909154814316"><a name="p6909154814316"></a><a name="p6909154814316"></a>人脸清晰度，范围[0,1]，值越大表示质量越高。</p>
        </td>
        </tr>
        <tr id="row1909164863118"><td class="cellrowborder" valign="top" width="27.27%" headers="mcps1.2.4.1.1 "><p id="p490917480318"><a name="p490917480318"></a><a name="p490917480318"></a>quality_pose</p>
        </td>
        <td class="cellrowborder" valign="top" width="15.15%" headers="mcps1.2.4.1.2 "><p id="p2090920487315"><a name="p2090920487315"></a><a name="p2090920487315"></a>Float</p>
        </td>
        <td class="cellrowborder" valign="top" width="57.58%" headers="mcps1.2.4.1.3 "><p id="p16909144883111"><a name="p16909144883111"></a><a name="p16909144883111"></a>人脸姿态分，范围[0,1]，值越小表示人脸<span>姿态</span>越正</p>
        </td>
        </tr>
        <tr id="row6909124853118"><td class="cellrowborder" valign="top" width="27.27%" headers="mcps1.2.4.1.1 "><p id="p090934863110"><a name="p090934863110"></a><a name="p090934863110"></a>quality_blur</p>
        </td>
        <td class="cellrowborder" valign="top" width="15.15%" headers="mcps1.2.4.1.2 "><p id="p890920485313"><a name="p890920485313"></a><a name="p890920485313"></a>Float</p>
        </td>
        <td class="cellrowborder" valign="top" width="57.58%" headers="mcps1.2.4.1.3 "><p id="p159091548183118"><a name="p159091548183118"></a><a name="p159091548183118"></a>人脸模糊度 ，范围[0,1]，值越小表示人脸越清晰</p>
        </td>
        </tr>
        <tr id="row209091848153117"><td class="cellrowborder" valign="top" width="27.27%" headers="mcps1.2.4.1.1 "><p id="p79098486316"><a name="p79098486316"></a><a name="p79098486316"></a>bbox</p>
        </td>
        <td class="cellrowborder" valign="top" width="15.15%" headers="mcps1.2.4.1.2 "><p id="p13909194815317"><a name="p13909194815317"></a><a name="p13909194815317"></a>Object</p>
        </td>
        <td class="cellrowborder" valign="top" width="57.58%" headers="mcps1.2.4.1.3 "><p id="p7909104813316"><a name="p7909104813316"></a><a name="p7909104813316"></a>人脸在原图中的检测框位置信息，详细说明见<a href="#table1591012481316">表8</a>。</p>
        </td>
        </tr>
        </tbody>
        </table>

        **表 8** “bbox“参数说明

        <a name="table1591012481316"></a>
        <table><thead align="left"><tr id="row6909104813112"><th class="cellrowborder" valign="top" width="27.27%" id="mcps1.2.4.1.1"><p id="p390974810316"><a name="p390974810316"></a><a name="p390974810316"></a>字段</p>
        </th>
        <th class="cellrowborder" valign="top" width="15.15%" id="mcps1.2.4.1.2"><p id="p16909848193110"><a name="p16909848193110"></a><a name="p16909848193110"></a>类型</p>
        </th>
        <th class="cellrowborder" valign="top" width="57.58%" id="mcps1.2.4.1.3"><p id="p7909194843120"><a name="p7909194843120"></a><a name="p7909194843120"></a>说明</p>
        </th>
        </tr>
        </thead>
        <tbody><tr id="row169091848173114"><td class="cellrowborder" valign="top" width="27.27%" headers="mcps1.2.4.1.1 "><p id="p7909448203111"><a name="p7909448203111"></a><a name="p7909448203111"></a>x</p>
        </td>
        <td class="cellrowborder" valign="top" width="15.15%" headers="mcps1.2.4.1.2 "><p id="p1990914817315"><a name="p1990914817315"></a><a name="p1990914817315"></a>Int</p>
        </td>
        <td class="cellrowborder" valign="top" width="57.58%" headers="mcps1.2.4.1.3 "><p id="p1390918487314"><a name="p1390918487314"></a><a name="p1390918487314"></a>检测框左上角顶点的x坐标值。</p>
        </td>
        </tr>
        <tr id="row1990924813312"><td class="cellrowborder" valign="top" width="27.27%" headers="mcps1.2.4.1.1 "><p id="p209092048103111"><a name="p209092048103111"></a><a name="p209092048103111"></a>y</p>
        </td>
        <td class="cellrowborder" valign="top" width="15.15%" headers="mcps1.2.4.1.2 "><p id="p1790974810315"><a name="p1790974810315"></a><a name="p1790974810315"></a>Int</p>
        </td>
        <td class="cellrowborder" valign="top" width="57.58%" headers="mcps1.2.4.1.3 "><p id="p1890924823117"><a name="p1890924823117"></a><a name="p1890924823117"></a>检测框左上角顶点的y坐标值。</p>
        </td>
        </tr>
        <tr id="row99104489318"><td class="cellrowborder" valign="top" width="27.27%" headers="mcps1.2.4.1.1 "><p id="p9909348153116"><a name="p9909348153116"></a><a name="p9909348153116"></a>w</p>
        </td>
        <td class="cellrowborder" valign="top" width="15.15%" headers="mcps1.2.4.1.2 "><p id="p18909134853111"><a name="p18909134853111"></a><a name="p18909134853111"></a>Int</p>
        </td>
        <td class="cellrowborder" valign="top" width="57.58%" headers="mcps1.2.4.1.3 "><p id="p991013486319"><a name="p991013486319"></a><a name="p991013486319"></a>检测框宽度。</p>
        </td>
        </tr>
        <tr id="row12910548183114"><td class="cellrowborder" valign="top" width="27.27%" headers="mcps1.2.4.1.1 "><p id="p591017486319"><a name="p591017486319"></a><a name="p591017486319"></a>h</p>
        </td>
        <td class="cellrowborder" valign="top" width="15.15%" headers="mcps1.2.4.1.2 "><p id="p14910348113112"><a name="p14910348113112"></a><a name="p14910348113112"></a>Int</p>
        </td>
        <td class="cellrowborder" valign="top" width="57.58%" headers="mcps1.2.4.1.3 "><p id="p7910134818314"><a name="p7910134818314"></a><a name="p7910134818314"></a>检测框高度。</p>
        </td>
        </tr>
        </tbody>
        </table>

    -   示例

        人脸客流统计的json消息体示例如下：

        ```
        { 
          "msg_type": "face_detection_result",
          "cam_name": "store001_pos2",
          "skill_id": "f5c526eb6c51440c8a0ee5e3cc65f23c",
          "time": 1527603463,
          "track_id": 1,
          "person_id": "0DD1BEA6-634B-11E8-8B0B-407D0FAD9218",
          "person_image": "4AAQSkZJRgABAQAAAQABAAD/2wBDAAIBAQE...",
          "ori_img_id": "0DD1BF0A-634B-11E8-8B0B-407D0FAD9218",
          "ori_image": "4AAQSkZJRgABAQAAAQABAAD/2wBDAAIBAQE...",
          "face_image": "4AAQSkZJRgABAQAAAQABAAD/2wBDAAIBAQE...",
          "clarity": 0.35,
          "quality_pose": 0.45,
          "quality_blur": 0.55,
          "bbox ": {
                     "x": 32,
                     "y": 379,
                     "w": 49,
                     "h": 65
                     },
         }
        ```


-   **响应消息**
    -   响应消息头

        响应消息头由服务器端\(应用系统\)收到请求消息后返回。

        响应消息头可包含如下两部分。

        -   一个HTTP状态代码，从2xx成功代码到4xx或5xx错误代码。或者可以返回服务定义的状态码。
        -   附加响应头字段，如支持请求的响应所需，如Content-type响应消息头。

        详细的公共响应消息头参数说明如[表9](#table93081840181617)所示。

        **表 9**  公共响应消息头参数说明

        <a name="table93081840181617"></a>
        <table><thead align="left"><tr id="row1530744041619"><th class="cellrowborder" valign="top" width="23%" id="mcps1.2.4.1.1"><p id="p8307184081614"><a name="p8307184081614"></a><a name="p8307184081614"></a>名称</p>
        </th>
        <th class="cellrowborder" valign="top" width="44%" id="mcps1.2.4.1.2"><p id="p3307040201613"><a name="p3307040201613"></a><a name="p3307040201613"></a>描述</p>
        </th>
        <th class="cellrowborder" valign="top" width="33%" id="mcps1.2.4.1.3"><p id="p930744017169"><a name="p930744017169"></a><a name="p930744017169"></a>示例</p>
        </th>
        </tr>
        </thead>
        <tbody><tr id="row73071440101617"><td class="cellrowborder" valign="top" width="23%" headers="mcps1.2.4.1.1 "><p id="p330734020165"><a name="p330734020165"></a><a name="p330734020165"></a>Date</p>
        </td>
        <td class="cellrowborder" valign="top" width="44%" headers="mcps1.2.4.1.2 "><p id="p103075407169"><a name="p103075407169"></a><a name="p103075407169"></a>HTTP协议标准报头。表示消息发送的时间，时间的描述格式由rfc822定义。</p>
        </td>
        <td class="cellrowborder" valign="top" width="33%" headers="mcps1.2.4.1.3 "><p id="p630794011618"><a name="p630794011618"></a><a name="p630794011618"></a>Mon, 12 Nov 2007 15:55:01 GMT</p>
        </td>
        </tr>
        <tr id="row15308040151610"><td class="cellrowborder" valign="top" width="23%" headers="mcps1.2.4.1.1 "><p id="p183071940131616"><a name="p183071940131616"></a><a name="p183071940131616"></a>Server</p>
        </td>
        <td class="cellrowborder" valign="top" width="44%" headers="mcps1.2.4.1.2 "><p id="p14308740121619"><a name="p14308740121619"></a><a name="p14308740121619"></a>HTTP协议标准报头。包含了服务器用来处理请求的软件信息。</p>
        </td>
        <td class="cellrowborder" valign="top" width="33%" headers="mcps1.2.4.1.3 "><p id="p43081940181618"><a name="p43081940181618"></a><a name="p43081940181618"></a>Apache</p>
        </td>
        </tr>
        <tr id="row12308040171610"><td class="cellrowborder" valign="top" width="23%" headers="mcps1.2.4.1.1 "><p id="p133081440161619"><a name="p133081440161619"></a><a name="p133081440161619"></a>Content-Length</p>
        </td>
        <td class="cellrowborder" valign="top" width="44%" headers="mcps1.2.4.1.2 "><p id="p8308184041616"><a name="p8308184041616"></a><a name="p8308184041616"></a>HTTP协议标准报头。用于指明实体正文的长度，以字节方式存储的十进制数字来表示。</p>
        </td>
        <td class="cellrowborder" valign="top" width="33%" headers="mcps1.2.4.1.3 "><p id="p43081240141615"><a name="p43081240141615"></a><a name="p43081240141615"></a>xxx</p>
        </td>
        </tr>
        <tr id="row830844017169"><td class="cellrowborder" valign="top" width="23%" headers="mcps1.2.4.1.1 "><p id="p133083406163"><a name="p133083406163"></a><a name="p133083406163"></a>Content-Type</p>
        </td>
        <td class="cellrowborder" valign="top" width="44%" headers="mcps1.2.4.1.2 "><p id="p1630884091611"><a name="p1630884091611"></a><a name="p1630884091611"></a>HTTP协议标准报头。用于指明发送给接收者的实体正文的媒体类型。</p>
        </td>
        <td class="cellrowborder" valign="top" width="33%" headers="mcps1.2.4.1.3 "><p id="p63082402166"><a name="p63082402166"></a><a name="p63082402166"></a>application/json</p>
        </td>
        </tr>
        </tbody>
        </table>

    -   响应消息体（可选）

        响应消息体通常以结构化格式（如json或xml）返回，与响应消息头中**Content-type**对应，传递除响应消息头之外的内容。



